# æ•°ç»„æ‰å¹³åŒ–

**`flat()`**  æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éåŽ†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸ŽéåŽ†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›žã€‚

## è¯­æ³•

```js
var newArray = arr.flat([depth])
```

- å‚æ•°

  `depth` å¯é€‰

  æŒ‡å®šè¦æå–åµŒå¥—æ•°ç»„çš„ç»“æž„æ·±åº¦ï¼Œ**é»˜è®¤å€¼ä¸º 1**ã€‚

- è¿”å›žå€¼

  ä¸€ä¸ªåŒ…å«å°†æ•°ç»„ä¸Žå­æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ çš„æ–°æ•°ç»„ã€‚

## ç¤ºä¾‹

```javascript
const nested = [ ['ðŸ“¦', 'ðŸ“¦'], ['ðŸ“¦']]

const flattened = nested.flat()

console.log(flattened)
// ['ðŸ“¦', 'ðŸ“¦', 'ðŸ“¦']
```

`flat()`æ–¹æ³•è®¾ç½® `depth` å‚æ•°ï¼š

```javascript
const twoLevelsDeep = [[1, [2, 2], 1]];

// depth = 1
twoLevelsDeep.flat()
// [1, [2, 2], 1]

// depth = 2
twoLevelsDeep.flat(2)
// [1, 2, 2, 1]
```

`flat()`æ–¹æ³•è®¾ç½® `depth` å‚æ•°ä¸º `Infinity`ï¼š

```javascript
const veryDeep = [[1, [2, 2, [3,[4,[5,[6]]]]], 1]];

veryDeep.flat(Infinity);
// [1, 2, 2, 3, 4, 5, 6, 1]
```

`flat()` æ–¹æ³•ä¼šç§»é™¤æ•°ç»„ä¸­çš„ç©ºé¡¹

```js
const missingNumbers = [1, ,3, ,5];

missingNumbers.flat();
// [1, 3, 5];
```

## polyfill

- `reduce` + `concat` +` isArray` +` recursivity`

  ```js
  Array.prototype.flat = function (depth = 1) {
    return depth > 0 ? this.reduce(
      (prev, next) => prev.concat(Array.isArray(next) ? next.flat(depth - 1) : next)
      , [])
      : this
  } 
  ```
  
-   `map` + `concat` +`spread` + `isArray` + `recursivity`
  
  ```js
  Array.prototype.flat = function(depth = 1){
    return depth > 0 ? [].concat(...this.map(v => Array.isArray(v) ? v.flat(depth - 1) : v))
    : this
  }
  ```